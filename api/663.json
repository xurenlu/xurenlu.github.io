{"title":"社区全文检索引擎Hyper Estraier 学习笔记[4]","zzzContent":"<strong><a href=\"#\">如何搭建一个Web界面的搜索界面</a></strong>\n现在我的硬盘上有Linux帮助,php中文文档,mysql文档,C函数手册等文档等，它们一共有500M.\n我需要一个索引工具。但是明显在命令行不是太方便。因为这些文档全是HTML格式的，我需要用浏览器来打开它们查看。\n我决定在本机架设一个apache,利用hyperestraier来进行索引，提供像Google/baidu那样的web界面。\n这是我的操作步骤:\n1 准备目录:\n   我在www目录下新建了两个目录，search/tool和search/search_doc目录，将属主改为apache(这是我的apache运行的用户名).\n   search/tool/用来放置hyperestraier的程序和索引数据库，search_doc/下放置原始的各种帮助文档。\n2.索引帮助文档:\n  在search/tool/目录下:\n\t<coolcode>\n\testcmd create man_docs_db\n\tfind ../search_doc/ -name \"*.html\" -type f|estcmd gather -cl -fm -cm ./man_docs_db -\n\t</coolcode>\n 然后Hyperestraier就哗啦哗啦地索引这500多M的文要资料。很快就索引完了。\n3.进行CGI和estseek.cgi的相关设置。\n  我们将编译hyperestraier目录下产生的estseek.*复制到search_tool目录下，并修改apache的关于CGI的配置:\n\t<coolcode>\n<directory /home/y/www/search_tool/>\nOptions +ExecCGI\naddHandler cgi-script cgi pl\n</directory>\n\t</coolcode>\n\t现在search_tool目录下的estseek.cgi能被执行了.当然你得执行chmod a+x estseek.cgi或是chmod 0755 estseek.cgi给这个文件加上执行权屯限。\n  接着编辑search_tool目录下的estseek.conf文件:\n<coolcode>\nindexname: man_docs_db\ntmplfile: estseek.tmpl\ntopfile: estseek.top\nhelpfile: estseek.help\nlockindex: true\npseudoindex:\nreplace: ^file:///home/y/www/search_doc/{{!}}/search_doc/\nreplace: /index.html?${{!}}/\nshowlreal: false\ndeftitle: Hyper Estraier: a full-text search system for communities\nformtype: normal\nperpage: 10 100 10\nattrselect: false\n#genrecheck: private{{!}}private\n#genrecheck: business{{!}}business\n#genrecheck: misc{{!}}miscellaneous\nattrwidth: 80\nshowscore: true\nextattr: author|Author\nextattr: from|From\nextattr: to|To\nextattr: cc|Cc\nextattr: date|Date\nsnipwwidth: 480\nsniphwidth: 96\nsnipawidth: 96\ncondgstep: 2\ndotfidf: true\nscancheck: 3\nphraseform: 2\ndispproxy:\ncandetail: true\ncandir: false\nauxmin: 32\nsmlrvnum: 32\nsmlrtune: 16 1024 4096\nclipview: 2\nclipweight: none\nrelkeynum: 0\nspcache:\nwildmax: 256\nqxpndcmd:\nlogfile:\nlogformat: {time}t{REMOTE_ADDR}:{REMOTE_PORT}t{cond}t{hnum}n\n\n</coolcode>\n\t这里主要要修改indexname和replace.\n\t说明:\n\t\tindexname是你前面用estcmd create命令创建的索引数据库的名字.\n\t\treplace可以多行，能对搜索结果中显示的文件路径做一个正则替换。因为索引入库的URL是file:///home/***类似\n\t的路径，在web中显示出来没法访问。\n好的，现在在search_tool/目录创建一个首页index.html,并给一个表单:\n\t<coolcode>\n\t<form method=\"GET\" action=\"estseek.cgi\">\n<div>\n<input type=\"text\" name=\"phrase\" value=\"\" size=\"32\" />\n<input type=\"submit\" value=\"Search\" />\n<input type=\"hidden\" name=\"enc\" value=\"UTF-8\" />\n</div>\n</form>\n\t</coolcode>\n\t现在就可以通过<a href=\"http://localhost/search_tool/\">http://localhost/search_tool/</a>来搜索你的帮助文档了。\n<hr />\n后记:\n但是，很快我发现几个问题:\n    1:Hyperestraier在处理gb2312的文档时，似乎有时侦测文档的编码类型会失败。搜索的时候对应的结果没有。\n<del datetime=\"2008-07-12T06:33:20+00:00\">    2.在显示搜索结果的摘要时，没有过滤HTML标签。</del>这是我问题:我在检索的时候应该用的是:\n<coolcode>\nfind ../search_doc/ -name \"*.html\" -type f|estcmd gather -cl -fm -cm -fh ./man_docs_db -\n</coolcode>\n这才能按照html来解析，否则是按mime来解析的。\n    3.搜两个词时，我期望的是同时包含其中任何一个词的网页都能出来，但是Hyperestraier就只搜同时包含这两个词的网页，所以搜长点的词经常结果为空。\n   4.对于有些词，比如中文的\"的\",英文的\"the\",没有进行忽略。当然这对目前的应用来说不是太大的问题。\n   但是无论如何，前三个问题，迫切需要解决。下一次就来抓一个出来处理掉。","postDate":"2008-07-12 12:56:10","postId":663,"type":"post","status":"publish","imported":true,"file":"663.md"}