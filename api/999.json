{"title":"PHP版的slow-query","zzzContent":"slowphp是由本人开发的一个简单的PHP扩展。目的在于记录web server上执行时间过长的php脚本。用法和mysql上的slow query极为相似。\n代码地址:<a href=\"http://github.com/xurenlu/slowphp/\">http://github.com/xurenlu/slowphp/</a>.本周内即可完成全部功能。\n版本: 1.0\n示例:在php.ini中加入:\n<coolcode>\nextension=slowphp.so\n[slowphp]\nslowphp.long_query_time=3\nslowphp.long_query_log=\"/var/log/php_long_query.log\"\n</coolcode>\n然后重启yapache,运行一段时间后即可查看/var/log/php_long_query.php中记录下了慢脚本的启动时间，消耗时间和脚本路径。\n下一步功能:\n为了方便调试，下一步将在ini中多加这样两项配置:\n<coolcode>\nslowphp.long_query_log_probability=0.0001\nslowphp.long_query_lock_file=\"/tmp/open_long_query\"\n</coolcode>\n功能分别为:\n1.有0.0001的概率记录当前脚本执行时间。\n2.有/tmp/open_long_query文件存在时才记录脚本运行文件。\n这样一来能极大地方便线上脚本运行效率的监控。","postDate":"2009-11-04 17:32:51","postId":999,"type":"post","status":"publish","imported":true,"file":"999.md"}