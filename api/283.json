{"title":"select id,title from ** 与select * from **的速度测试。","zzzContent":"老是喜欢用select *,后来自己觉着不行，会影响速度，今天俺 做一个测试看看倒底有多大影响?\n数据表结构:\n<coolcode lang=\"sql\">\nCREATE TABLE `xoops__art_text` (\n  `text_id` int(11) NOT NULL auto_increment,\n  `art_id` int(11) NOT NULL default '0',\n  `text_title` varchar(255) NOT NULL default '',\n  `text_body` longblob,\n  PRIMARY KEY  (`text_id`),\n  KEY `art_id` (`art_id`)\n)\n</coolcode>\n测试文件代码:\n<coolcode lang=\"php\">\n<style type=\"text/css\">\n\tdiv{\n\tborder:1px solid black;\n\tbackground-color:#888;\n\theight:20px;\n\tmargin-left:30px;\n\tdisplay:inline;\n\talign:left;\n\ttext-align:right;\n\t}\n</style>\n<?php\n\tfunction test(){\n\t$dbserver=\"localhost:3306\";\n\t$dbuser=\"testuser\";\n\t$dbpass=\"testuser\";\n\t$dbname=\"test\";\n\t$max=100;\n\t$connection=mysql_connect($dbserver,$dbuser,$dbpass);\n\tmysql_select_db($dbname);\n\n\n\n\t$sqls=array();\n\t$sqls[]=\"select text_id,cateid from text limit 100\";\n\t$sqls[]=\"select text_id,cateid,text_title from text limit 100\";\n\t$sqls[]=\"select text_id,cateid,text_title,text_body from text limit 100\";\n\n\n\t$time1=new timer();\n\t$i=0;\n\tforeach($sqls as $sql)\n\t{\n\t\t$time1->reset();\n\t\tfor($j=0;$j<$max;$j++)\n\t\t$rs=mysql_query($sql);\n\t\t$times[$i]=$time1->tick();\n\t\tif($times[$i]>$max) $max=$times[$i];\n\t\t$i++;\n\t}\n\tprint_r($times);\n\t$texts=array();\n\t$texts[]=\"method a:\";\n\t$texts[]=\"method b:\";\n\t$texts[]=\"method c:\";\n\n\n\n\techo \"<br/>\";\n\techo \"max:$max;\";\n\techo \"<br/>\";\n\t$i=0;\n\tforeach($times as $time)\n\t{\n\t\techo $texts[$i++];\n\t\techo \"<div id=bar_$id style='width:\".(($time/$max)*780).\"px;'>&nbsp;\";\n\t\techo $time.\"ms \";\n\t\techo \"</div><br/>\";\n\t}\n}\ntest();\ntest();\ntest();\ntest();\ntest();\ntest();\ntest();\ntest();\n class timer\n {\n     var $_start;\n     var $_current;\n     function timer()\n     {\n     /**\n     这是记录下开始操作时的时间。\n     */\n         $this->_start = array_sum(explode(' ', microtime()));\n     }\n     function tick()\n     {\n\n         $this->_current = round((array_sum(explode(' ', microtime()))-$this->_start)*1000, 0);\n         return $this->_current;\n     }\n     function reset()\n     {\n         $this->timer();\n     }\n }\n\n\n\t?>\n</coolcode>\n测出来的一组结果:\n<coolcode>\nmethod a: 79ms\nmethod b: 79ms\nmethod c: 1010ms\n</coolcode>\n相比之下，当用了select * 之后，只多取了一个text/longblob类型的字段,整个时间相差了十几倍!\n所以，以后写代码，俺 还是要勤快一点，用select id,name,title 而不能用select *.那样太浪费资源了.","postDate":"2006-10-16 15:46:23","postId":283,"type":"post","status":"publish","imported":true,"file":"283.md"}