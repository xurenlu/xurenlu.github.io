{"title":"rails 每周乱弹:用ckeditor为表单添加所见即所得功能","zzzContent":"我最近在搞<a href=\"http://codeany.com/\">codeany.com</a>,用的rails开发,其中一些地方需要用到所见即所得编辑器,不想自己写了,上网搜了搜,找到了一个叫做ckeditor的rails插件,主页是:<a href=\"http://github.com/galetahub/rails-ckeditor\">http://github.com/galetahub/rails-ckeditor</a>;\n安装方法:\n<coolcode>\n./script/plugin install git://github.com/galetahub/rails-ckeditor.git\n</coolcode>\n或者用是\n<coolcode>\n./script/plugin install http://github.com/galetahub/rails-ckeditor.git\n</coolcode>\ngit协议能快一点点;这种安装需要你有git;另外你下载下来安装,下载地址是:<a href=\"http://github.com/galetahub/rails-ckeditor/tarball/master\" target=\"_blank\">http://github.com/galetahub/rails-ckeditor/tarball/master</a>.\n安装好以后设置数据库和配置文件;\n<coolcode>\nrake ckeditor:install\nrake ckeditor:config\n</coolcode>\n现在就好了,使用很简单,比如以前的代码是:\n<coolcode>\n<%form_for(....) do |f|%>\n<%=f.text_area :content,:rows=>5,:cols=>60%>\n...<%end%>\n</coolcode>\n<coolcode>\n<%form_for(....) do |f|%>\n<%= f.cktext_area :content, :swf_params=>{:assetable_type=>'User', :assetable_id=>session[:uid]} %>\n...<%end%>\n</coolcode>\n并在页头加上:\n<coolcode>\n<%= javascript_include_tag :ckeditor %>\n</coolcode>\n即可;ckeditor和jquery等良好共存,并无问题.\n下面说一下文件上传:\nckeditor上是带有上传图片并插入到所见即所得编辑器中去的功能,我是用的paperclip来实现,ckeditor对这个有支持,启用很简单,从ckeditor的示例目录中将几个model文件拷过来:\n<coolcode>\ncp vendor/plugins/rails-ckeditor/examples/models/paperclip/* app/models/\n</coolcode>\n这会拷贝这几个文件:\n<coolcode>\n asset.rb\n attachment_file.rb\n picture.rb\n</coolcode>\n并在数据库中创建assets表:\n<coolcode>\n CREATE TABLE `assets` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `data_file_name` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,\n  `data_content_type` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,\n  `data_file_size` int(11) DEFAULT NULL,\n  `assetable_id` int(11) DEFAULT NULL,\n  `assetable_type` varchar(25) COLLATE utf8_unicode_ci DEFAULT NULL,\n  `type` varchar(25) COLLATE utf8_unicode_ci DEFAULT NULL,\n  `user_id` int(11) DEFAULT NULL,\n  `created_at` datetime DEFAULT NULL,\n  `updated_at` datetime DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  KEY `ndx_type_assetable` (`assetable_id`,`assetable_type`,`type`),\n  KEY `fk_assets` (`assetable_id`,`assetable_type`),\n  KEY `fk_user` (`user_id`)\n) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci\n</coolcode>\n即可了.\n这个也可以上ckeditor的主页去看,ckeditor的主页写得很全面了,少部分地方不够细致,需要摸索一下.","postDate":"2010-07-25 13:03:40","postId":1156,"type":"post","status":"publish","imported":true,"file":"1156.md"}