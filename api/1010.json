{"title":"对TokyoTyrant的一个简单的patch,以支持列出所有的Key","zzzContent":"有人在网上评价说Redis、mongodb等Key-value对的数据库，说redis特别牛，能支持列出所有的key;\n其实tokyotyrant也是可以的呀，因为我看他底层持tcmdb,tchdb等都是支持遍历所有Key的，于是小小地做了一个改动,以支持列出的tokyotyrant的所有Key.\n代码放在http://github.com/xurenlu/mc_list_patch_4_tokyotyrant上了。\n用法:\n1.启动ttserver:\nttserver db.tch\n3.telnet上去，试试set命令:\n\ntelnet localhost 1978\n    Trying 127.0.0.1…\n    Connected to localhost.localdomain.\n    Escape character is '^]'.\n    set kw2 1 1 3\n    123\n    STORED\n    list\n    LIST 9\n    kw\n    kw2\n    END\n看这里,已经支持list命令了。\n2 再用php客户端来连接:我还没有去用c写php的memcached客户端，就从网上找了一个php做的类，在git目录里有:\n\ninclude \"memcache.class.php\";\n    $hosts = array('127.0.0.1:1978');\n    $mc = &new MemCachedClient($hosts);\n    var_dump($mc->listkeys());\n关于安装:\n1.tokyotyrant基于tokyocabinet,需要先安装 tokyocabinet,请在http://github.com/xurenlu/mc_list_patch_4_tokyotyrant/downloads 下载.\n\n~/download@aragorn   $ wget http://cloud.github.com/downloads/xurenlu/mc_list_patch_4_tokyotyrant/tokyocabinet-1.4.41.tar.gz\n~/download@aragorn   $ tar -xzf tokyocabinet-1.4.41.tar.gz\n~/download@aragorn   $ cd tokyocabinet-1.4.41\n~/download/tokyocabinet-1.4.41@aragorn  $ ./configure\n….省却若干输出…\n~/download/tokyocabinet-1.4.41@aragorn  $  make && make install\n接下来，请先下载tokyotyrant 1.1.37,可以在http://github.com/xurenlu/mc_list_patch_4_tokyotyrant/downloads 这里下载.\n下载下来后，解压、patch：\n\n~/download@aragorn   $ wget http://cloud.github.com/downloads/xurenlu/mc_list_patch_4_tokyotyrant/tokyotyrant-1.1.37.tar.gz\n~/download@aragorn   $ tar -xzf tokyotyrant-1.1.37.tar.gz\n~/download@aragorn   $ patch -p0 < mc_list.patch\npatching file tokyotyrant-1.1.37/ttserver.c\n然后编译tokyotyrant:\n\n~/download/@aragorn  $cd tokyotyrant-1.1.37\n~/download/tokyotyrant-1.1.37/@aragorn $ ./configure\n…..若干输出，略去..\n~/download/tokyotyrant-1.1.37/@aragorn $ make && sudo make install\n接下来就可以启动ttserver来玩了。","postDate":"2010-03-07 11:55:40","postId":1010,"type":"post","status":"publish","imported":true,"file":"1010.md"}