{"title":"一个测试PHP效率的代码，检测Single Quote,Double Quote,HereDoc的效率","zzzContent":"<coolcode lang='php'>\n<?php\n/**\n* fileoper是一个文件操作类\n*\n*<pre> 目前有writeover,readover,mkdir三个方法。\n*其三个方法均是静态方法。注意mkdir可以\n*  逐级地建目录，这是与php自带的mkdir不\n* 同的地方。所有对文件的操作都应该通过\n* 这个对象进行，这样可以通过改写这个对\n* 象实现对文件IO过程的日志。</pre>\n*\n*@package  authorcn\n*@subpackage  common\n*@author renlu <helloasp@hotmail.com>\n*@link http://www.162cm.com\n*@example  FILEOper::writeover(\"d.txt\",\"hello,this is a test.\")\n*@name fileoper\n*/\nclass fileoper  {\n\t/**\n\t*读取文件内容。\n\t*@param $filename 给定的文件名.\n\t*@return   string(文件内容)\n\t*@access  private\n\t*@static\n\t*/\n\t  function readover($filename)\n\t{\n\t\tif(file_exists($filename))\n\t\t{\n\t\t\t$file=fopen($filename,\"r\");\n\t\t\tflock($file,LOCK_SH);\n\t\t\t$filedetail=fread($file,filesize($filename));\n\t\t\tfclose($file);\n\t\t\treturn $filedetail;\n\t\t}\n\t\telse\n\t\treturn \"\";\n\t}\n\t/**\n\t*写入数据函数\n\t*@param  $fileanme  文件名称\n\t*@param  $data  文 件内容\n\t*@param  $method  已经不再用了.\n\t*@access  private\n\t*@static\n\t*/\n\t  function writeover($filename,$data,$method=\"w\")\n\t{\n\t\t$file=fopen($filename,$method);\n\t\tflock($file,LOCK_EX);\n\t\t$filedetail=fwrite($file,$data);\n\t\tfclose($file);\n\t\treturn $filedetail;\n\t}\n\t/**\n\t * 递归建立一个目录\n\t *\n\t * @param string $dirstring 目录名\n\t */\n\t   function mkdir($dirstring)\n\t{\n\t\t$dirstring=str_replace(\"\\\",\"/\",$dirstring);\n\t\t$arr=explode(\"/\",$dirstring);\n\t\t$temparr=array();\n\t\tfor($i=0;$i<sizeof($arr);$i++)\n\t\t{\n\t\t\t$temparr[]=$arr[$i];\n\t\t\t$path=implode(\"\\\",$temparr);\n\t\t\tif(!is_dir($path))\n\t\t\t{\n\t\t\t\techo $path;\n\t\t\t\tmkdir(implode(\"\\\",$temparr));\n\t\t\t}\n\t\t}\n\t}\n\t  function deletefile($file)\n\t{\n\t\tunlink($file);\n\t}\n\t  function file_exists($file)\n\t{\n\t\treturn file_exists($file);\n\t}\n\t  function is_file($file)\n\t{\n\t\treturn is_file($file);\n\t}\n\n\t/**\n\t * 将内容添加到一个文件的结尾\n\t *\n\t * @param string $filename 文件名\n\t * @param string $data 数据\n\t */\n\t  function appendfile($filename,$data)\n\t{\n\t\t$file=fopen($filename,\"a+\");\n\t\tflock($file,LOCK_EX);\n\t\t$filedetail=fwrite($file,$data);\n\t\tfclose($file);\n\t\treturn $filedetail;\n\t}\n}\n\nfunction returnNull()\n\t{\n\t\treturn \"\";\n\t}\nob_start(\"returnNull\");\n$time[]=time();\n$total=1000;\nfor($i=0;$i<$total;$i++)\n\t{\n\t\techo \"自在不成人，成人不自在。\n    能用钱解决的问题，都不是问题。但没有钱是最大的问题。\n    做什么也不做官。\n    缺什么都不能缺梦想。\n    与成功人共事，朝理想飞奔。\n    我肯定会成功的。\n    与员工同分享。10亿的百分之一也有1000万，10万的100%也只有10万。所以想办法挣10亿，而不是100%---愿与员工分享，是企员能做大的前提条件。\n    结识一批朋友，哪怕目前不能帮你任何忙。\n    人无完人，容人之过，知人善任，方可成事。\n    做梦也想成功的人，终会成功。\n    成大事者，集勇气、运气、耐心、平常心于一身也。\n    多走一小步，进步一大步。\n    为商者，利至上。然无客户至上,亦无利也。\n    先招忠士，再养悍将。\n    尝试每天进步一小步。\n    制定目标，并努力实现。\n    \"晚上我要学会自己做饭\",同\"我要在这个月学会开车\"，\"我要在明年升到销售总监的职位\"一样,也是一个目标。目标都应该努力实现。否则，修改您的目标。\n    重要的事先做，感兴趣的事是要多花时间做。\n    每天总结自己。\n    学会奉承你的手下，激励你的手下,引导你的手下，信任你的手下。\n    马上动手行动吧。不要拖延。\n    做之前先想好，做之后还要想。\n    给员工发足够的薪水。发不出薪水，再有前景的企业都留不住人。除非你的员工实在没地方去。\n    让员工感觉受到重视。\n    目标应该分段去实现。\n    要会说，也要做。有的人会做，但也要会说。\n    万一有一天你成功了，记住：不是因为你比别人更聪明，更有能力，可能只是你有一批能力不错的员工,还可能只是因为老天瞎了眼，把五百万大奖错发给你了。\n    活到老，学到老。想一切人学习，当然尽可能挑更成功的人学习。\n    告诉自己:我很愉快。我很有信心做好这件事。\n    培养自己的自制能力。\n    人往往败给自己。\n    学会养一些会偷懒的人。\n    要有心机。要学坏。学会拍马屁，学会给人戴高帽子。\n    人不可能无缺点。学会利用他人的缺点，总有突破口。\n    洞察一切，推测未来。虽然你不是姓诸葛的，也要去学着这么做。\";\n\t}\n$time[]=time();\nfor($i=0;$i<$total;$i++)\n\t{\n\t\techo '自在不成人，成人不自在。\n    能用钱解决的问题，都不是问题。但没有钱是最大的问题。\n    做什么也不做官。\n    缺什么都不能缺梦想。\n    与成功人共事，朝理想飞奔。\n    我肯定会成功的。\n    与员工同分享。10亿的百分之一也有1000万，10万的100%也只有10万。所以想办法挣10亿，而不是100%---愿与员工分享，是企员能做大的前提条件。\n    结识一批朋友，哪怕目前不能帮你任何忙。\n    人无完人，容人之过，知人善任，方可成事。\n    做梦也想成功的人，终会成功。\n    成大事者，集勇气、运气、耐心、平常心于一身也。\n    多走一小步，进步一大步。\n    为商者，利至上。然无客户至上,亦无利也。\n    先招忠士，再养悍将。\n    尝试每天进步一小步。\n    制定目标，并努力实现。\n    \"晚上我要学会自己做饭\",同\"我要在这个月学会开车\"，\"我要在明年升到销售总监的职位\"一样,也是一个目标。目标都应该努力实现。否则，修改您的目标。\n    重要的事先做，感兴趣的事是要多花时间做。\n    每天总结自己。\n    学会奉承你的手下，激励你的手下,引导你的手下，信任你的手下。\n    马上动手行动吧。不要拖延。\n    做之前先想好，做之后还要想。\n    给员工发足够的薪水。发不出薪水，再有前景的企业都留不住人。除非你的员工实在没地方去。\n    让员工感觉受到重视。\n    目标应该分段去实现。\n    要会说，也要做。有的人会做，但也要会说。\n    万一有一天你成功了，记住：不是因为你比别人更聪明，更有能力，可能只是你有一批能力不错的员工,还可能只是因为老天瞎了眼，把五百万大奖错发给你了。\n    活到老，学到老。想一切人学习，当然尽可能挑更成功的人学习。\n    告诉自己:我很愉快。我很有信心做好这件事。\n    培养自己的自制能力。\n    人往往败给自己。\n    学会养一些会偷懒的人。\n    要有心机。要学坏。学会拍马屁，学会给人戴高帽子。\n    人不可能无缺点。学会利用他人的缺点，总有突破口。\n    洞察一切，推测未来。虽然你不是姓诸葛的，也要去学着这么做。 ';\n\t}\n$time[]=time();\nfor($i=0;$i<$total;$i++)\n\t{\n\nprint <<< EOT\n\t自在不成人，成人不自在。\n    能用钱解决的问题，都不是问题。但没有钱是最大的问题。\n    做什么也不做官。\n    缺什么都不能缺梦想。\n    与成功人共事，朝理想飞奔。\n    我肯定会成功的。\n    与员工同分享。10亿的百分之一也有1000万，10万的100%也只有10万。所以想办法挣10亿，而不是100%---愿与员工分享，是企员能做大的前提条件。\n    结识一批朋友，哪怕目前不能帮你任何忙。\n    人无完人，容人之过，知人善任，方可成事。\n    做梦也想成功的人，终会成功。\n    成大事者，集勇气、运气、耐心、平常心于一身也。\n    多走一小步，进步一大步。\n    为商者，利至上。然无客户至上,亦无利也。\n    先招忠士，再养悍将。\n    尝试每天进步一小步。\n    制定目标，并努力实现。\n    \"晚上我要学会自己做饭\",同\"我要在这个月学会开车\"，\"我要在明年升到销售总监的职位\"一样,也是一个目标。目标都应该努力实现。否则，修改您的目标。\n    重要的事先做，感兴趣的事是要多花时间做。\n    每天总结自己。\n    学会奉承你的手下，激励你的手下,引导你的手下，信任你的手下。\n    马上动手行动吧。不要拖延。\n    做之前先想好，做之后还要想。\n    给员工发足够的薪水。发不出薪水，再有前景的企业都留不住人。除非你的员工实在没地方去。\n    让员工感觉受到重视。\n    目标应该分段去实现。\n    要会说，也要做。有的人会做，但也要会说。\n    万一有一天你成功了，记住：不是因为你比别人更聪明，更有能力，可能只是你有一批能力不错的员工,还可能只是因为老天瞎了眼，把五百万大奖错发给你了。\n    活到老，学到老。想一切人学习，当然尽可能挑更成功的人学习。\n    告诉自己:我很愉快。我很有信心做好这件事。\n    培养自己的自制能力。\n    人往往败给自己。\n    学会养一些会偷懒的人。\n    要有心机。要学坏。学会拍马屁，学会给人戴高帽子。\n    人不可能无缺点。学会利用他人的缺点，总有突破口。\n    洞察一切，推测未来。虽然你不是姓诸葛的，也要去学着这么做。\nEOT;\n\n\t}\n$time[]=time();\nfor($i=0;$i<$total;$i++)\n\t{\n\t\techo sprintf(\"自在不成人，成人不自在。\n    能用钱解决的问题，都不是问题。但没有钱是最大的问题。\n    做什么也不做官。\n    缺什么都不能缺梦想。\n    与成功人共事，朝理想飞奔。\n    我肯定会成功的。\n    与员工同分享。10亿的百分之一也有1000万，10万的100%也只有10万。所以想办法挣10亿，而不是100%---愿与员工分享，是企员能做大的前提条件。\n    结识一批朋友，哪怕目前不能帮你任何忙。\n    人无完人，容人之过，知人善任，方可成事。\n    做梦也想成功的人，终会成功。\n    成大事者，集勇气、运气、耐心、平常心于一身也。\n    多走一小步，进步一大步。\n    为商者，利至上。然无客户至上,亦无利也。\n    先招忠士，再养悍将。\n    尝试每天进步一小步。\n    制定目标，并努力实现。\n    \"晚上我要学会自己做饭\",同\"我要在这个月学会开车\"，\"我要在明年升到销售总监的职位\"一样,也是一个目标。目标都应该努力实现。否则，修改您的目标。\n    重要的事先做，感兴趣的事是要多花时间做。\n    每天总结自己。\n    学会奉承你的手下，激励你的手下,引导你的手下，信任你的手下。\n    马上动手行动吧。不要拖延。\n    做之前先想好，做之后还要想。\n    给员工发足够的薪水。发不出薪水，再有前景的企业都留不住人。除非你的员工实在没地方去。\n    让员工感觉受到重视。\n    目标应该分段去实现。\n    要会说，也要做。有的人会做，但也要会说。\n    万一有一天你成功了，记住：不是因为你比别人更聪明，更有能力，可能只是你有一批能力不错的员工,还可能只是因为老天瞎了眼，把五百万大奖错发给你了。\n    活到老，学到老。想一切人学习，当然尽可能挑更成功的人学习。\n    告诉自己:我很愉快。我很有信心做好这件事。\n    培养自己的自制能力。\n    人往往败给自己。\n    学会养一些会偷懒的人。\n    要有心机。要学坏。学会拍马屁，学会给人戴高帽子。\n    人不可能无缺点。学会利用他人的缺点，总有突破口。\n    洞察一切，推测未来。虽然你不是姓诸葛的，也要去学着这么做。 \");\n\t}\n$time[]=time();\n$str=\"结果:n\";\n$str.=join(\"n\",$time);\n\nfileoper::writeover(\"do.txt\",$str);\n?>\n\n</coolcode>\n检测结果:\n以下分别为几次测试结果:\n<coolcode >\n结果:\n1160578850\n1160578851\n1160578855\n1160578862\n1160578863\n</coolcode>\n这次双引号用了1秒，单引号用了4秒,hereDoc用了7秒,sprintf用了1秒。\n\n<coolcode >\n结果:\n1160578710\n1160578711\n1160578715\n1160578722\n1160578722\n</coolcode>\n这次双引号用了1秒，单引号用了4秒,hereDoc用了7秒,sprintf用了0秒(我想是不到1秒)。\n\n<coolcode>\n结果:\n1160578773\n1160578775\n1160578779\n1160578786\n1160578787\n</coolcode>\n这次双引号用了2秒，单引号用了4秒,hereDoc用了7秒,sprintf用了1秒。\n\n三次汇总，是<del datetime=\"2006-10-12T13:36:15+00:00\">sprintf最快</del>，heredoc最慢。双引号要比单引号快，这个我想不通，不知道为什么?明明双引号还要做替换，为什么却还更慢?\n但是根据PHP.net上的结果，应该是单引号最快，双引号其次，heredoc第三，sprintf最慢。是不是我的代码有问题？谁能告诉我一下?\n\n<em>很丢人的说　俺用错了sprintf..... 怪不得那么快.关于sprintf的取消...<br/>\n我后来查了一下，确实是双引号最快，单引号其次，Heredoc最慢。是我当时记错了。\n</em>","postDate":"2006-10-11 23:18:12","postId":280,"type":"post","status":"publish","imported":true,"file":"280.md"}